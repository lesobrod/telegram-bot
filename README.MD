# Бот подбора отелей в Telegram

Этот бот быстро ищет отели в Telegram по различным критериям поиска.  
Постоянная ссылка: https://t.me/HeartTravelBot

## Возможности бота

Он позволяет:
* Подбирать отели низкой или высокой стоимости
* Подбирать отели по соотношению цена/расстояние от центра города
* Задавать количество выводимых отелей
* Задавать диапазон цен
* Просматривать фото отеля и комнат
* Просматривать историю поиска


## Команды бота

* `/start` - Пуск
* `/help` - Список команд и их описание
* `/lowprice` - Топ дешевых отелей
* `/highprice` - Топ дорогих отелей
* `/bestdeal` - Лучшие предложения
* `/history` - История поиска


## Инструкции для разработчика 
Проект написан с использованием Python 3.10, но совместим с версиями 3.7+ 

Он требует установки дополнительных библиотек:
* [pyTelegramBotAPI](https://github.com/python-telegram-bot/python-telegram-bot) – Python Telegram Bot API
* [requests](https://github.com/psf/requests) – библиотека запросов requests
* [redis](https://redis.io/) – база данных для каждого пользователя
* [loguru](https://github.com/Delgan/loguru) – умное логирование
* [python-dotenv](https://github.com/theskumar/python-dotenv) – работа с переменными окружения

Все зависимости можно установить, выполнив команду:  
`pip install -r requirements.txt`

### Работа с Redis (вариант облачного хранения)
1. [Зарегистрируйтесь в системе](https://redis.io/)
2. Выберите бесплатный тариф
3. Создайте базу данных. Ее название условно
4. Получите точку входа (Endpoint:port_number) и пароль 
5. Внесите точку входа в переменную DATA_BASE_ENDPOINT файла config.py
6. Внесите пароль в переменную окружения REDIS_PASS

### Логинг
Файл логирования bot.log появляется в папке /logs.
Параметры можно настроить в файле config.py:
* SINK - имя лог-файла
* CLEAR_LOGS - очищаем ли лог при перезапуске бота
* FULL_LOGS - записывать ли в лог большие объемы данных, или только ключевые
* MONITOR_LOGS - дублировать ли лог в терминал
* LOGGER_CONFIG:"format" - формат строки
* Множество других настроек доступно в описании библиотеки loguru

### Переменные окружения
Файл .env.template нужно переименовать в .env и в него внести актуальные пароли:
* Базы данных HOTELS API 
* Базы данных REDIS
* Пароль бота, выданный @BotFather

## Инструкция для конечных пользователей
Команды можно вводить тремя способами:
* Напрямую с клавиатуры
* Нажав на предыдущую аналогичную
* Нажав на кнопку внизу

### Топ дешевых отелей

1. Введите команду `/lowprice`. Бот запросит название города.
2. Введите название. Бот выполнит запрос к hotels api и выведет возможные геолокации.
3. Выберите один из вариантов, наиболее подходящий вашему запросу.
4. Введите желаемое количество отелей. 
5. Ответьте Да/Нет на вопрос, нужны ли фото
6. Если да - бот попросит ввести количество фото: фото отеля и фото комнат, через пробел
7. Бот выполнит запрос к hotels api и выведет карточки отелей с данными и фото под ними.

### Топ дорогих отелей

Аналогично с командой `/highprice`

### Лучшие предложения

1. Пункты 1-3 аналогично предыдущему.
2. Далее бот запросит диапазон цен на отели. Введите два числа через пробел, 
где первое число это минимальная стоимость отеля, а второе — максимальная.
3. Бот уточнит максимальное расстояние от центра города до отеля. 
4. Бот запросит количество отелей, которые вы хотите вывести в качестве результата. 
5. Далее аналогично предыдущему.
